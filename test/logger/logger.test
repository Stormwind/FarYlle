package require tcltest
namespace import ::tcltest::*

source logger/Logger.tcl

test createLogger {} -body {
  set logger [Logger new]
  info object class $logger
} -result "::Logger"

test getAllLogLevels {} -body {
  $logger getAllLogLevels
} -result "debug error info notice"


test setLogChannel {} -body {
  $logger setLogChannel "info" stdout
} -result 1

test setInvalidLogChannel {} -body {
  try {
    $logger setLogChannel "foobar" stdout
    } trap {LOG BADLEVEL} {message} {
      puts $message
    }
} -output "Cannot set channel for log level 'foobar', because this log level does not exist.\n"

test logInfo {} -body {
  $logger logMessage "info" "Info log message."
} -output "Info log message.\n" -result 1

test logInfoToEmptyChannel {} -body {
  $logger setLogChannel "info" 0
  $logger logMessage "info" "Info log message."
} -result 0

test LogMessageToNonExistingChannel {} -body {
  try {
    $logger logMessage "foobar" "Foobar log message."
  } trap {LOG BADLEVEL} {message} {
    puts $message
  }
} -output "Cannot log message to level 'foobar', because this log level does not exist.\n"

cleanupTests
